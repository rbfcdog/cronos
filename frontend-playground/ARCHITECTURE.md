# Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Header.tsx                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  x402 Agent Playground    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Zap Icon â”‚  Cronos Developer Sandbox  â”‚ ðŸŸ¢ Cronos  â”‚  â”‚ Connect  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚   Testnet  â”‚  â”‚  Wallet  â”‚  â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Main Layout                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         â”‚                                      â”‚                 â”‚  â”‚
â”‚  â”‚  Drag   â”‚         Plan Canvas                  â”‚   Simulator     â”‚  â”‚
â”‚  â”‚ Palette â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   Controls      â”‚  â”‚
â”‚  â”‚         â”‚  â”‚                              â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚  â”‚ Simulation â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ðŸ—„ï¸ readâ”‚ â”‚  â”‚  â”‚ Block 1: read_bal â”‚   â”‚   â”‚  â”‚    Live    â”‚ â”‚  â”‚
â”‚  â”‚ â”‚balanceâ”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                              â”‚   â”‚                 â”‚  â”‚
â”‚  â”‚         â”‚  â”‚  â†“                           â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚  â”‚ Simulate   â”‚ â”‚  â”‚
â”‚  â”‚ â”‚âš¡x402 â”‚ â”‚  â”‚  â”‚ Block 2: x402_pay  â”‚   â”‚   â”‚  â”‚   Plan     â”‚ â”‚  â”‚
â”‚  â”‚ â”‚paymentâ”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                              â”‚   â”‚                 â”‚  â”‚
â”‚  â”‚         â”‚  â”‚  Empty State:                â”‚   â”‚                 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚  â”‚  "Drag blocks here..."       â”‚   â”‚  Json Output   â”‚  â”‚
â”‚  â”‚ â”‚ðŸ“„cont â”‚ â”‚  â”‚                              â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ract  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚ {         â”‚ â”‚  â”‚
â”‚  â”‚ â”‚_call â”‚ â”‚                                      â”‚  â”‚  "mode":  â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚                                      â”‚  â”‚  ...      â”‚ â”‚  â”‚
â”‚  â”‚         â”‚                                      â”‚  â”‚ }         â”‚ â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚                                      â”‚  â”‚ [Copy]    â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ðŸŽ›ï¸condâ”‚ â”‚                                      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ â”‚itionâ”‚ â”‚                                      â”‚                 â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚         â”‚                                                           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚                                                           â”‚
â”‚  â”‚ â”‚ðŸ‘ï¸ readâ”‚                                                           â”‚
â”‚  â”‚ â”‚_stateâ”‚                                                           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚                                                           â”‚
â”‚  â”‚         â”‚                                                           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚                                                           â”‚
â”‚  â”‚ â”‚âœ…approâ”‚                                                           â”‚
â”‚  â”‚ â”‚ve_tokâ”‚                                                           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚                                                           â”‚
â”‚  â”‚         â”‚                                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      Trace Viewer                â”‚    Unified State Panel        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚ Run ID: run_1234         â”‚    â”‚  â”‚ ðŸ’° Wallet             â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ Plan ID: plan_5678       â”‚    â”‚  â”‚  Address: 0x...       â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚  Balances:            â”‚    â”‚  â”‚
â”‚  â”‚                                  â”‚  â”‚   â€¢ CRO: 100.0        â”‚    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚   â€¢ USDT: 50.0        â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ âœ… Step 1: read_balance   â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚  â”‚    Gas: 21000            â”‚    â”‚                               â”‚  â”‚
â”‚  â”‚  â”‚    Tx: 0xabc...def       â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚    [Expand â–¼]            â”‚    â”‚  â”‚ ðŸ“„ Contracts          â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚  ExecutionRouter      â”‚    â”‚  â”‚
â”‚  â”‚                                  â”‚  â”‚   Status: Active       â”‚    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚   Address: 0x...      â”‚    â”‚  â”‚
â”‚  â”‚  â”‚ âœ… Step 2: x402_payment   â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚  â”‚    Gas: 45000            â”‚    â”‚                               â”‚  â”‚
â”‚  â”‚  â”‚    Tx: 0x123...456       â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚    [Expand â–¼]            â”‚    â”‚  â”‚ âš¡ x402 Protocol       â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚  Executions: 42       â”‚    â”‚  â”‚
â”‚  â”‚                                  â”‚  â”‚  Status: Enabled      â”‚    â”‚  â”‚
â”‚  â”‚  Loading: [Skeleton...]         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Data Flow:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. User drags block from DragPalette â†’ PlanCanvas
2. BlockItem renders in PlanCanvas with edit capability
3. User edits block data â†’ updates state in page.tsx
4. JsonOutput displays real-time plan JSON
5. User clicks "Simulate" in SimulatorControls
6. page.tsx makes POST to /api/playground/simulate
7. TraceViewer receives and displays execution steps
8. UnifiedStatePanel shows updated wallet/contract state

Component Props:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Header
  â””â”€ No props (uses RainbowKit ConnectButton)

DragPalette
  â””â”€ No props (uses useDraggable internally)

PlanCanvas
  â”œâ”€ blocks: BlockType[]
  â”œâ”€ removeBlock: (id: string) => void
  â””â”€ updateBlock: (id: string, data: any) => void

BlockItem
  â”œâ”€ block: BlockType
  â”œâ”€ onRemove: () => void
  â””â”€ onUpdate: (data: any) => void

JsonOutput
  â””â”€ plan: ExecutionPlan

SimulatorControls
  â”œâ”€ mode: "simulate" | "execute"
  â”œâ”€ setMode: (mode) => void
  â”œâ”€ onSimulate: () => void
  â”œâ”€ onExecute: () => void
  â”œâ”€ isLoading: boolean
  â””â”€ isValidPlan: boolean

TraceViewer
  â”œâ”€ trace: ExecutionTrace | null
  â””â”€ isLoading?: boolean

UnifiedStatePanel
  â””â”€ state: UnifiedState | null

Type Definitions (lib/types.ts):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ActionType = "read_balance" | "x402_payment" | "contract_call" | 
             "condition" | "read_state" | "approve_token"

BlockType {
  id: string
  type: ActionType
  data: Record<string, any>
}

ExecutionPlan {
  mode: "simulate" | "execute"
  planId: string
  actions: ExecutionAction[]
  context?: Record<string, any>
  description?: string
}

ExecutionTrace {
  runId: string
  planId: string
  mode: "simulate" | "execute"
  steps: TraceStep[]
  virtualState?: UnifiedState
  warnings?: string[]
  errors?: string[]
  metadata: { startedAt, completedAt, duration, ... }
}

UnifiedState {
  wallet: { address, balances }
  contracts: { name, address, status }[]
  x402: { executionsCount, enabled }
}
```
